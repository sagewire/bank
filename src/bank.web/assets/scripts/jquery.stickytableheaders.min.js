/*! Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
	MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
(function(n,t){"use strict";function f(f,e){var o=this;o.$el=n(f);o.el=f;o.id=r++;o.$el.bind("destroyed",n.proxy(o.teardown,o));o.$clonedHeader=null;o.$originalHeader=null;o.cachedHeaderHeight=null;o.isSticky=!1;o.hasBeenSticky=!1;o.leftOffset=null;o.topOffset=null;o.init=function(){o.setOptions(e);o.$el.each(function(){var t=n(this);t.css("padding",0);o.$originalHeader=n("thead:first",this);o.$clonedHeader=o.$originalHeader.clone();t.trigger("clonedHeader."+i,[o.$clonedHeader]);o.$clonedHeader.addClass("tableFloatingHeader");o.$clonedHeader.css({display:"none",opacity:0});o.$originalHeader.addClass("tableFloatingHeaderOriginal");o.$originalHeader.after(o.$clonedHeader);o.$printStyle=n('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}<\/style>');o.$head.append(o.$printStyle)});o.updateWidth();o.toggleHeaders();o.bind()};o.destroy=function(){o.$el.unbind("destroyed",o.teardown);o.teardown()};o.teardown=function(){o.isSticky&&o.$originalHeader.css("position","static");n.removeData(o.el,"plugin_"+i);o.unbind();o.$clonedHeader.remove();o.$originalHeader.removeClass("tableFloatingHeaderOriginal");o.$originalHeader.css("visibility","visible");o.$printStyle.remove();o.el=null;o.$el=null};o.bind=function(){o.$scrollableArea.on("scroll."+i,o.toggleHeaders);if(!o.isWindowScrolling){o.$window.on("scroll."+i+o.id,o.setPositionValues);o.$window.on("resize."+i+o.id,o.toggleHeaders)}o.$scrollableArea.on("resize."+i,o.toggleHeaders);o.$scrollableArea.on("resize."+i,o.updateWidth)};o.unbind=function(){o.$scrollableArea.off("."+i,o.toggleHeaders);o.isWindowScrolling||(o.$window.off("."+i+o.id,o.setPositionValues),o.$window.off("."+i+o.id,o.toggleHeaders));o.$scrollableArea.off("."+i,o.updateWidth)};o.debounce=function(n,t){var i=null;return function(){var r=this,u=arguments;clearTimeout(i);i=setTimeout(function(){n.apply(r,u)},t)}};o.toggleHeaders=o.debounce(function(){o.$el&&o.$el.each(function(){var t=n(this),f,r=o.isWindowScrolling?isNaN(o.options.fixedOffset)?o.options.fixedOffset.outerHeight():o.options.fixedOffset:o.$scrollableArea.offset().top+(isNaN(o.options.fixedOffset)?0:o.options.fixedOffset),u=t.offset(),e=o.$scrollableArea.scrollTop()+r,s=o.$scrollableArea.scrollLeft(),h=o.options.cacheHeaderHeight?o.cachedHeaderHeight:o.$clonedHeader.height(),c=o.isWindowScrolling?e>u.top:r>u.top,l=(o.isWindowScrolling?e:0)<u.top+t.height()-h-(o.isWindowScrolling?0:r);c&&l?(f=u.left-s+o.options.leftOffset,o.$originalHeader.css({position:"fixed","margin-top":o.options.marginTop,left:f,"z-index":3}),o.leftOffset=f,o.topOffset=r,o.$clonedHeader.css("display",""),o.isSticky||(o.isSticky=!0,o.updateWidth(),t.trigger("enabledStickiness."+i)),o.setPositionValues()):o.isSticky&&(o.$originalHeader.css("position","static"),o.$clonedHeader.css("display","none"),o.isSticky=!1,o.resetWidth(n("td,th",o.$clonedHeader),n("td,th",o.$originalHeader)),t.trigger("disabledStickiness."+i))})},0);o.setPositionValues=o.debounce(function(){var n=o.$window.scrollTop(),t=o.$window.scrollLeft();!o.isSticky||n<0||n+o.$window.height()>o.$document.height()||t<0||t+o.$window.width()>o.$document.width()||o.$originalHeader.css({top:o.topOffset-(o.isWindowScrolling?0:n),left:o.leftOffset-(o.isWindowScrolling?0:t)})},0);o.updateWidth=o.debounce(function(){if(o.isSticky){o.$originalHeaderCells||(o.$originalHeaderCells=n("th,td",o.$originalHeader));o.$clonedHeaderCells||(o.$clonedHeaderCells=n("th,td",o.$clonedHeader));var t=o.getWidth(o.$clonedHeaderCells);o.setWidth(t,o.$clonedHeaderCells,o.$originalHeaderCells);o.$originalHeader.css("width",o.$el.width());o.options.cacheHeaderHeight&&(o.cachedHeaderHeight=o.$clonedHeader.height())}},0);o.getWidth=function(i){var r=[];return i.each(function(i){var f,u=n(this),e,s;if(u.css("box-sizing")==="border-box")e=u[0].getBoundingClientRect(),f=e.width?e.width:e.right-e.left;else if(s=n("th",o.$originalHeader),s.css("border-collapse")==="collapse")if(t.getComputedStyle)f=parseFloat(t.getComputedStyle(this,null).width);else{var h=parseFloat(u.css("padding-left")),c=parseFloat(u.css("padding-right")),l=parseFloat(u.css("border-width"));f=u.outerWidth()-h-c-l}else f=u.width();r[i]=f}),r};o.setWidth=function(n,t,i){t.each(function(t){var r=n[t];i.eq(t).css({"min-width":r,"max-width":r})})};o.resetWidth=function(t,i){t.each(function(t){var r=n(this);i.eq(t).css({"min-width":r.css("min-width"),"max-width":r.css("max-width")})})};o.setOptions=function(t){o.options=n.extend({},u,t);o.$window=n(o.options.objWindow);o.$head=n(o.options.objHead);o.$document=n(o.options.objDocument);o.$scrollableArea=n(o.options.scrollableArea);o.isWindowScrolling=o.$scrollableArea[0]===o.$window[0]};o.updateOptions=function(n){o.setOptions(n);o.unbind();o.bind();o.updateWidth();o.toggleHeaders()};o.init()}var i="stickyTableHeaders",r=0,u={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,objHead:"head",objWindow:t,scrollableArea:t,cacheHeaderHeight:!1};n.fn[i]=function(t){return this.each(function(){var r=n.data(this,"plugin_"+i);r?typeof t=="string"?r[t].apply(r):r.updateOptions(t):t!=="destroy"&&n.data(this,"plugin_"+i,new f(this,t))})}})(jQuery,window);