"use strict";(function(n){typeof module=="object"&&typeof module.exports=="object"?n(require("jquery"),window,document):n(jQuery,window,document)})(function(n,t,i){function d(n){return Math.sqrt((n.touches[0].clientX-n.touches[1].clientX)*(n.touches[0].clientX-n.touches[1].clientX)+(n.touches[0].clientY-n.touches[1].clientY)*(n.touches[0].clientY-n.touches[1].clientY))}function l(n,t){var i=n.css("transform");i==="none"?n.css("transform","scale("+t+","+t+")"):i.indexOf("3d")===-1?n.css("transform",i+" scale("+t+","+t+")"):n.css("transform",i+" scale3d("+t+","+t+", 1)")}function g(t){var i={name:t.contents().eq(0).text().trim(),relationship:(t.parent().parent().is("li")?"1":"0")+(t.siblings("li").length?1:0)+(t.children("ul").length?1:0)};return t[0].id&&(i.id=t[0].id),t.children("ul").children().each(function(){i.children||(i.children=[]);i.children.push(g(n(this)))}),i}function a(n,t){return n.relationship=t+(n.children&&n.children.length>0?1:0),n.children&&n.children.forEach(function(t){a(t,"1"+(n.children.length>1?1:0))}),n}function nt(t){var r=t.find("tr:first"),i={id:r.find(".node")[0].id};return r.siblings(":last").children().each(function(){i.children||(i.children=[]);i.children.push(nt(n(this)))}),i}function ot(t){var t=t||n(this).find(".orgchart");return t.find(".node:first")[0].id?nt(t):"Error: Nodes of orghcart to be exported must have id attribute!"}function r(n,t){var i={};return(t==="parent"?i=n.closest(".nodes").siblings(":first"):t==="children"?i=n.closest("tr").siblings():t==="siblings"&&(i=n.closest("table").parent().siblings()),i.length)?i.is(":visible")?{exist:!0,visible:!0}:{exist:!0,visible:!1}:{exist:!1,visible:!1}}function st(n,t){return t==="parent"?n.closest(".nodes").parent().children(":first").find(".node"):t==="children"?n.closest("table").children(":last").children().find(".node:first"):t==="siblings"?n.closest("table").parent().siblings().find(".node:first"):void 0}function v(n){var i=n.closest("table").closest("tr").siblings(),u,t,f;if(i.eq(0).find(".spinner").length&&n.closest(".orgchart").data("inAjax",!1),r(n,"siblings").visible&&e(n),u=i.slice(1),u.css("visibility","hidden"),t=i.eq(0).find(".node"),f=r(t,"parent").visible,t.length&&t.is(":visible"))t.addClass("slide slide-down").one("transitionend",function(){t.removeClass("slide");u.removeAttr("style");i.addClass("hidden")});t.length&&f&&v(t)}function y(t){var r=t.closest("table").closest("tr").siblings().removeClass("hidden"),i;r.eq(2).children().slice(1,-1).addClass("hidden");i=r.eq(0).find(".node")[0];c(i);n(i).addClass("slide").removeClass("slide-down").one("transitionend",function(){n(i).removeClass("slide");f(t)&&s(t.children(".topEdge"))})}function tt(n){var t=n.closest("tr").siblings(),i,r,u;t.last().find(".spinner").length&&n.closest(".orgchart").data("inAjax",!1);i=t.last().find(".node:visible");r=t.last().is(".verticalNodes")?!0:!1;r||(u=i.closest("table").closest("tr").prevAll(".lines").css("visibility","hidden"));i.addClass("slide slide-up").eq(0).one("transitionend",function(){i.removeClass("slide");r?t.addClass("hidden"):(u.removeAttr("style").addClass("hidden").siblings(".nodes").addClass("hidden"),t.last().find(".verticalNodes").addClass("hidden"));f(n)&&s(n.children(".bottomEdge"))})}function p(n){var t=n.closest("tr").siblings(),r=t.is(".verticalNodes")?!0:!1,i=r?t.removeClass("hidden").find(".node:visible"):t.removeClass("hidden").eq(2).children().find("tr:first").find(".node:visible");c(i.get(0));i.addClass("slide").removeClass("slide-up").eq(0).one("transitionend",function(){i.removeClass("slide");f(n)&&s(n.children(".bottomEdge"))})}function e(n,t){var i=n.closest("table").parent(),r,u;i.siblings().find(".spinner").length&&n.closest(".orgchart").data("inAjax",!1);t?t==="left"?i.prevAll().find(".node:visible").addClass("slide slide-right"):i.nextAll().find(".node:visible").addClass("slide slide-left"):(i.prevAll().find(".node:visible").addClass("slide slide-right"),i.nextAll().find(".node:visible").addClass("slide slide-left"));r=i.siblings().find(".slide");u=r.closest(".nodes").prevAll(".lines").css("visibility","hidden");r.eq(0).one("transitionend",function(){u.removeAttr("style");var e=t?t==="left"?i.prevAll(":not(.hidden)"):i.nextAll(":not(.hidden)"):i.siblings();i.closest(".nodes").prev().children(":not(.hidden)").slice(1,t?e.length*2+1:-1).addClass("hidden");r.removeClass("slide");e.find(".node:visible:gt(0)").removeClass("slide-left slide-right").addClass("slide-up").end().find(".lines, .nodes, .verticalNodes").addClass("hidden").end().addClass("hidden");f(n)&&h(n)})}function o(t,i){var e=n(),u,o;if(e=i?i==="left"?t.closest("table").parent().prevAll().removeClass("hidden"):t.closest("table").parent().nextAll().removeClass("hidden"):t.closest("table").parent().siblings().removeClass("hidden"),u=t.closest("table").closest("tr").siblings(),i?u.eq(2).children(".hidden").slice(0,e.length*2).removeClass("hidden"):u.eq(2).children(".hidden").removeClass("hidden"),!r(t,"parent").visible){u.removeClass("hidden");o=u.find(".node")[0];c(o);n(o).addClass("slide").removeClass("slide-down").one("transitionend",function(){n(this).removeClass("slide")})}e.find(".node:visible").addClass("slide").removeClass("slide-left slide-right").eq(-1).one("transitionend",function(){e.find(".node:visible").removeClass("slide");f(t)&&(h(t),t.children(".topEdge").removeClass("fa-chevron-up").addClass("fa-chevron-down"))})}function w(t,i,r){var u=i.closest(".orgchart");return typeof u.data("inAjax")!="undefined"&&u.data("inAjax")===!0?!1:(t.addClass("hidden"),i.append('<i class="fa fa-circle-o-notch fa-spin spinner"><\/i>'),i.children().not(".spinner").css("opacity",.2),u.data("inAjax",!0),n(".oc-export-btn"+(r.chartClass!==""?"."+r.chartClass:"")).prop("disabled",!0),!0)}function b(t,i,r){var u=i.closest("div.orgchart");t.removeClass("hidden");i.find(".spinner").remove();i.children().removeAttr("style");u.data("inAjax",!1);n(".oc-export-btn"+(r.chartClass!==""?"."+r.chartClass:"")).prop("disabled",!1)}function f(n){return n.children(".edge").attr("class").indexOf("fa-")>-1?!0:!1}function s(n){n.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down")}function h(n){var f=n.closest(".orgchart").data("options"),i,r,u,t;f.toggleSiblingsResp&&(typeof f.ajaxURL=="undefined"||n.closest(".nodes").data("siblingsLoaded"))?(i=n.closest("table").parent().prev(),i.length&&(i.is(".hidden")?n.children(".leftEdge").addClass("fa-chevron-left").removeClass("fa-chevron-right"):n.children(".leftEdge").addClass("fa-chevron-right").removeClass("fa-chevron-left")),r=n.closest("table").parent().next(),r.length&&(r.is(".hidden")?n.children(".rightEdge").addClass("fa-chevron-right").removeClass("fa-chevron-left"):n.children(".rightEdge").addClass("fa-chevron-left").removeClass("fa-chevron-right"))):(u=n.closest("table").parent().siblings(),t=u.length?!u.is(".hidden"):!1,n.children(".leftEdge").toggleClass("fa-chevron-right",t).toggleClass("fa-chevron-left",!t),n.children(".rightEdge").toggleClass("fa-chevron-left",t).toggleClass("fa-chevron-right",!t))}function c(n){n&&(n.style.offsetWidth=n.offsetWidth)}function it(u,l,a){var nt;n.each(u.children,function(n,t){t.parentId=u.id});var g=n.Deferred(),k=n("<div"+(a.draggable?' draggable="true"':"")+(u[a.nodeId]?' id="'+u[a.nodeId]+'"':"")+(u.parentId?' data-parent="'+u.parentId+'"':"")+">").addClass("node "+(u.className||"")+(l>=a.depth?" slide-up":"")).append('<div class="title">'+u[a.nodeTitle]+"<\/div>").append(typeof a.nodeContent!="undefined"?'<div class="content">'+(u[a.nodeContent]||"")+"<\/div>":""),d=u.relationship||"";a.verticalDepth&&l+2>a.verticalDepth?l+1>=a.verticalDepth&&Number(d.substr(2,1))&&(nt=l+1>=a.depth?"plus":"minus",k.append('<i class="toggleBtn fa fa-'+nt+'-square"><\/i>')):(Number(d.substr(0,1))&&k.append('<i class="edge verticalEdge topEdge fa"><\/i>'),Number(d.substr(1,1))&&k.append('<i class="edge horizontalEdge rightEdge fa"><\/i><i class="edge horizontalEdge leftEdge fa"><\/i>'),Number(d.substr(2,1))&&k.append('<i class="edge verticalEdge bottomEdge fa"><\/i>').children(".title").prepend('<i class="fa '+a.parentNodeSymbol+' symbol"><\/i>'));k.on("mouseenter mouseleave",function(t){var i=n(this),u=!1,f=i.children(".topEdge"),s=i.children(".rightEdge"),e=i.children(".bottomEdge"),o=i.children(".leftEdge");t.type==="mouseenter"?(f.length&&(u=r(i,"parent").visible,f.toggleClass("fa-chevron-up",!u).toggleClass("fa-chevron-down",u)),e.length&&(u=r(i,"children").visible,e.toggleClass("fa-chevron-down",!u).toggleClass("fa-chevron-up",u)),o.length&&h(i)):i.children(".edge").removeClass("fa-chevron-up fa-chevron-down fa-chevron-right fa-chevron-left")});k.on("click",function(){n(this).closest(".orgchart").find(".focused").removeClass("focused");n(this).addClass("focused")});k.on("click",".topEdge",function(t){var o,l;t.stopPropagation();var e=n(this),i=e.parent(),c=r(i,"parent");if(c.exist){if(o=i.closest("table").closest("tr").siblings(":first").find(".node"),o.is(".slide"))return;if(c.visible){v(i);o.one("transitionend",function(){f(i)&&(s(e),h(i))})}else y(i)}else l=e.parent()[0].id,w(e,i,a)&&n.ajax({url:n.isFunction(a.ajaxURL.parent)?a.ajaxURL.parent(u):a.ajaxURL.parent+l,dataType:"json"}).done(function(t){i.closest(".orgchart").data("inAjax")&&(n.isEmptyObject(t)||ft.call(i.closest(".orgchart").parent(),i,t,a))}).fail(function(){console.log("Failed to get parent node data")}).always(function(){b(e,i,a)})});k.on("click",".bottomEdge",function(t){var o,s;t.stopPropagation();var f=n(this),i=f.parent(),e=r(i,"children");if(e.exist){if(o=i.closest("tr").siblings(":last"),o.find(".node:visible").is(".slide"))return;e.visible?tt(i):p(i)}else s=f.parent()[0].id,w(f,i,a)&&n.ajax({url:n.isFunction(a.ajaxURL.children)?a.ajaxURL.children(u):a.ajaxURL.children+s,dataType:"json"}).done(function(t){i.closest(".orgchart").data("inAjax")&&t.children.length&&ut(i,t,n.extend({},a,{depth:0}))}).fail(function(){console.log("Failed to get children nodes data")}).always(function(){b(f,i,a)})});k.on("click",".toggleBtn",function(){var u=n(this),r=u.parent().next(),t=r.find(".node"),i=r.children().children(".node");if(!i.is(".slide"))if(u.toggleClass("fa-plus-square fa-minus-square"),t.eq(0).is(".slide-up")){r.removeClass("hidden");c(i.get(0));i.addClass("slide").removeClass("slide-up").eq(0).one("transitionend",function(){i.removeClass("slide")})}else{t.addClass("slide slide-up").eq(0).one("transitionend",function(){t.removeClass("slide");t.closest("ul").addClass("hidden")});t.find(".toggleBtn").removeClass("fa-minus-square").addClass("fa-plus-square")}});k.on("click",".leftEdge, .rightEdge",function(t){var c,l,v,s,y;t.stopPropagation();var f=n(this),i=f.parent(),h=r(i,"siblings");if(h.exist){if(c=i.closest("table").parent().siblings(),c.find(".node:visible").is(".slide"))return;a.toggleSiblingsResp?(l=i.closest("table").parent().prev(),v=i.closest("table").parent().next(),f.is(".leftEdge")?l.is(".hidden")?o(i,"left"):e(i,"left"):v.is(".hidden")?o(i,"right"):e(i,"right")):h.visible?e(i):o(i)}else s=f.parent()[0].id,y=r(i,"parent").exist?n.isFunction(a.ajaxURL.siblings)?a.ajaxURL.siblings(u):a.ajaxURL.siblings+s:n.isFunction(a.ajaxURL.families)?a.ajaxURL.families(u):a.ajaxURL.families+s,w(f,i,a)&&n.ajax({url:y,dataType:"json"}).done(function(n){i.closest(".orgchart").data("inAjax")&&(n.siblings||n.children)&&et(i,n,a)}).fail(function(){console.log("Failed to get sibling nodes data")}).always(function(){b(f,i,a)})});if(a.draggable)k.on("dragstart",function(r){var e=r.originalEvent,y=/firefox/.test(t.navigator.userAgent.toLowerCase()),o,f,l,u,s,h,v;y&&e.dataTransfer.setData("text/html","hack for firefox");k.closest(".orgchart").css("transform")!=="none"&&(i.querySelector(".ghost-node")?(o=k.closest(".orgchart").children(".ghost-node").get(0),f=n(o).children().get(0)):(o=i.createElementNS("http://www.w3.org/2000/svg","svg"),o.classList.add("ghost-node"),f=i.createElementNS("http://www.w3.org/2000/svg","rect"),o.appendChild(f),k.closest(".orgchart").append(o)),l=k.closest(".orgchart").css("transform").split(","),u=Math.abs(t.parseFloat(a.direction==="t2b"||a.direction==="b2t"?l[0].slice(l[0].indexOf("(")+1):l[1])),o.setAttribute("width",k.outerWidth(!1)),o.setAttribute("height",k.outerHeight(!1)),f.setAttribute("x",5*u),f.setAttribute("y",5*u),f.setAttribute("width",120*u),f.setAttribute("height",40*u),f.setAttribute("rx",4*u),f.setAttribute("ry",4*u),f.setAttribute("stroke-width",1*u),s=e.offsetX*u,h=e.offsetY*u,a.direction==="l2r"?(s=e.offsetY*u,h=e.offsetX*u):a.direction==="r2l"?(s=k.outerWidth(!1)-e.offsetY*u,h=e.offsetX*u):a.direction==="b2t"&&(s=k.outerWidth(!1)-e.offsetX*u,h=k.outerHeight(!1)-e.offsetY*u),y?(f.setAttribute("fill","rgb(255, 255, 255)"),f.setAttribute("stroke","rgb(191, 0, 0)"),v=i.createElement("img"),v.src="data:image/svg+xml;utf8,"+(new XMLSerializer).serializeToString(o),e.dataTransfer.setDragImage(v,s,h)):e.dataTransfer.setDragImage(o,s,h));var c=n(this),p=c.closest(".nodes").siblings().eq(0).find(".node:first"),w=c.closest("table").find(".node");c.closest(".orgchart").data("dragged",c).find(".node").each(function(t,i){w.index(i)===-1&&(a.dropCriteria?a.dropCriteria(c,p,n(i))&&n(i).addClass("allowedDrop"):n(i).addClass("allowedDrop"))})}).on("dragover",function(t){t.preventDefault();n(this).is(".allowedDrop")||(t.originalEvent.dataTransfer.dropEffect="none")}).on("dragend",function(){n(this).closest(".orgchart").find(".allowedDrop").removeClass("allowedDrop")}).on("drop",function(){var t=n(this),f=t.closest(".orgchart"),i=f.data("dragged"),r,h,e,o,u,s;f.find(".allowedDrop").removeClass("allowedDrop");r=i.closest(".nodes").siblings().eq(0).children();t.closest("tr").siblings().length?(h=parseInt(t.parent().attr("colspan"))+2,e='<i class="edge horizontalEdge rightEdge fa"><\/i><i class="edge horizontalEdge leftEdge fa"><\/i>',t.closest("tr").next().addBack().children().attr("colspan",h),i.find(".horizontalEdge").length||i.append(e),t.closest("tr").siblings().eq(1).children(":last").before('<td class="leftLine topLine">&nbsp;<\/td><td class="rightLine topLine">&nbsp;<\/td>').end().next().append(i.closest("table").parent()),o=i.closest("table").parent().siblings().find(".node:first"),o.length===1&&o.append(e)):t.append('<i class="edge verticalEdge bottomEdge fa"><\/i>').parent().attr("colspan",2).parent().after('<tr class="lines"><td colspan="2"><div class="downLine"><\/div><\/td><\/tr><tr class="lines"><td class="rightLine">&nbsp;<\/td><td class="leftLine">&nbsp;<\/td><\/tr><tr class="nodes"><\/tr>').siblings(":last").append(i.find(".horizontalEdge").remove().end().closest("table").parent());u=parseInt(r.attr("colspan"));u>2?(r.attr("colspan",u-2).parent().next().children().attr("colspan",u-2).end().next().children().slice(1,3).remove(),s=r.parent().siblings(".nodes").children().find(".node:first"),s.length===1&&s.find(".horizontalEdge").remove()):r.removeAttr("colspan").find(".bottomEdge").remove().end().end().siblings().remove();f.triggerHandler({type:"nodedropped.orgchart",draggedNode:i,dragZone:r.children(),dropZone:t})});return a.createNode&&a.createNode(k,u),g.resolve(k),g.promise()}function u(t,i,r,f,e){var o,c=i.children,p=c?c.length:!1,v=f.verticalDepth&&r+1>=f.verticalDepth?!0:!1,s,l,a,y,h;if(Object.keys(i).length>1&&(o=v?t:n("<table>"),v||t.append(o),n.when(it(i,r,f)).done(function(n){v?o.append(n):o.append(n.wrap("<tr><td"+(p?' colspan="'+c.length*2+'"':"")+"><\/td><\/tr>").closest("tr"));e&&e()}).fail(function(){console.log("Failed to creat node")})),p){for(Object.keys(i).length===1&&(o=t),s=r+1>=f.depth||i.collapsed?" hidden":"",l=f.verticalDepth&&r+2>=f.verticalDepth?!0:!1,l||o.append('<tr class="lines'+s+'"><td colspan="'+c.length*2+'"><div class="downLine"><\/div><\/td><\/tr>'),a='<tr class="lines'+s+'"><td class="rightLine">&nbsp;<\/td>',y=1;y<c.length;y++)a+='<td class="leftLine topLine">&nbsp;<\/td><td class="rightLine topLine">&nbsp;<\/td>';a+='<td class="leftLine">&nbsp;<\/td><\/tr>';l?(h=n("<ul>"),s&&h.addClass(s),r+2===f.verticalDepth?o.append('<tr class="verticalNodes'+s+'"><td><\/td><\/tr>').find(".verticalNodes").children().append(h):o.append(h)):(h=n('<tr class="nodes'+s+'">'),o.append(a).append(h));n.each(c,function(){var t=l?n("<li>"):n('<td colspan="2">');h.append(t);u(t,this,r+1,f,e)})}}function rt(n,t,i,r){var i=i||n.closest(".orgchart").data("options"),f=t.children||t.siblings;n.find("td:first").attr("colspan",f.length*2);u(n,{children:f},0,i,r)}function ut(n,t,i){var i=i||n.closest(".orgchart").data("options"),r=0;rt.call(n.closest(".orgchart").parent(),n.closest("table"),t,i,function(){++r===t.children.length&&(n.children(".bottomEdge").length||n.append('<i class="edge verticalEdge bottomEdge fa"><\/i>'),n.find(".symbol").length||n.children(".title").prepend('<i class="fa '+i.parentNodeSymbol+' symbol"><\/i>'),p(n))})}function ht(t,i,r,u){var e=this,f=n("<table>");i.relationship=i.relationship||"001";n.when(it(i,0,r||t.closest(".orgchart").data("options"))).done(function(n){var i,t;f.append(n.removeClass("slide-up").addClass("slide-down").wrap('<tr class="hidden"><td colspan="2"><\/td><\/tr>').closest("tr"));f.append('<tr class="lines hidden"><td colspan="2"><div class="downLine"><\/div><\/td><\/tr>');i='<td class="rightLine">&nbsp;<\/td><td class="leftLine">&nbsp;<\/td>';f.append('<tr class="lines hidden">'+i+"<\/tr>");t=e.children(".orgchart");t.prepend(f).children("table:first").append('<tr class="nodes"><td colspan="2"><\/td><\/tr>').children("tr:last").children().append(t.children("table").last());u()}).fail(function(){console.log("Failed to create parent node")})}function ft(n,t,i){ht.call(this,n,t,i,function(){n.children(".topEdge").length||n.children(".title").after('<i class="edge verticalEdge topEdge fa"><\/i>');y(n)})}function k(n,t,i){for(var r="",u=0;u<i;u++)r+='<td class="leftLine topLine">&nbsp;<\/td><td class="rightLine topLine">&nbsp;<\/td>';n.parent().prevAll("tr:gt(0)").children().attr("colspan",t*2).end().next().children(":first").after(r)}function ct(t,i,r,f){var r=r||t.closest(".orgchart").data("options"),h=i.siblings?i.siblings.length:i.children.length,s=t.parent().is("td")?t.closest("tr").children().length:1,o=s+h,e=o>1?Math.floor(o/2-1):0,a,c,l;t.parent().is("td")?(a=t.closest("tr").prevAll("tr:last"),t.closest("tr").prevAll("tr:lt(2)").remove(),c=0,rt.call(t.closest(".orgchart").parent(),t.parent().closest("table"),i,r,function(){if(++c===h){var n=t.parent().closest("table").children("tr:last").children("td");s>1?(k(n.eq(0).before(t.closest("td").siblings().addBack().unwrap()),o,s),n.addClass("hidden").find(".node").addClass("slide-left")):(k(n.eq(e).after(t.closest("td").unwrap()),o,1),n.not(":eq("+e+1+")").addClass("hidden").slice(0,e).find(".node").addClass("slide-right").end().end().slice(e).find(".node").addClass("slide-left"));f()}})):(l=0,u(t.closest(".orgchart"),i,0,r,function(){++l===o&&(k(t.next().children("tr:last").children().eq(e).after(n('<td colspan="2">').append(t)),o,1),t.closest("tr").siblings().eq(0).addClass("hidden").find(".node").addClass("slide-down"),t.parent().siblings().addClass("hidden").slice(0,e).find(".node").addClass("slide-right").end().end().slice(e).find(".node").addClass("slide-left"),f())}))}function et(n,t,i){ct.call(n.closest(".orgchart").parent(),n.closest("table"),t,i,function(){n.closest(".nodes").data("siblingsLoaded",!0);n.children(".leftEdge").length||n.children(".topEdge").after('<i class="edge horizontalEdge rightEdge fa"><\/i><i class="edge horizontalEdge leftEdge fa"><\/i>');o(n)})}function lt(n){var t=n.closest("table").parent(),i=t.parent().siblings();t.is("td")?r(n,"siblings").exist?(i.eq(2).children(".topLine:lt(2)").remove(),i.slice(0,2).children().attr("colspan",i.eq(2).children().length),t.remove()):i.eq(0).children().removeAttr("colspan").find(".bottomEdge").remove().end().end().siblings().remove():t.add(t.siblings()).remove()}n.fn.orgchart=function(f){var s,b,k;switch(f){case"buildHierarchy":return u.apply(this,Array.prototype.splice.call(arguments,1));case"addChildren":return ut.apply(this,Array.prototype.splice.call(arguments,1));case"addParent":return ft.apply(this,Array.prototype.splice.call(arguments,1));case"addSiblings":return et.apply(this,Array.prototype.splice.call(arguments,1));case"removeNodes":return lt.apply(this,Array.prototype.splice.call(arguments,1));case"getHierarchy":return ot.apply(this,Array.prototype.splice.call(arguments,1));case"hideParent":return v.apply(this,Array.prototype.splice.call(arguments,1));case"showParent":return y.apply(this,Array.prototype.splice.call(arguments,1));case"hideChildren":return tt.apply(this,Array.prototype.splice.call(arguments,1));case"showChildren":return p.apply(this,Array.prototype.splice.call(arguments,1));case"hideSiblings":return e.apply(this,Array.prototype.splice.call(arguments,1));case"showSiblings":return o.apply(this,Array.prototype.splice.call(arguments,1));case"getNodeState":return r.apply(this,Array.prototype.splice.call(arguments,1));case"getRelatedNodes":return st.apply(this,Array.prototype.splice.call(arguments,1));default:s=n.extend({nodeTitle:"name",nodeId:"id",toggleSiblingsResp:!1,depth:999,chartClass:"",exportButton:!1,exportFilename:"OrgChart",exportFileextension:"png",parentNodeSymbol:"fa-users",draggable:!1,direction:"t2b",pan:!1,zoom:!1},f)}var c=this,w=s.data,h=n("<div>",{data:{options:s},"class":"orgchart"+(s.chartClass!==""?" "+s.chartClass:"")+(s.direction!=="t2b"?" "+s.direction:""),click:function(t){n(t.target).closest(".node").length||h.find(".node.focused").removeClass("focused")}});if(n.type(w)==="object"?w instanceof n?u(h,g(w.children()),0,s):u(h,s.ajaxURL?w:a(w,"00"),0,s):n.ajax({url:w,dataType:"json",beforeSend:function(){h.append('<i class="fa fa-circle-o-notch fa-spin spinner"><\/i>')}}).done(function(n){u(h,s.ajaxURL?n:a(n,"00"),0,s)}).fail(function(n,t,i){console.log(i)}).always(function(){h.children(".spinner").remove()}),c.append(h),s.exportButton&&!c.find(".oc-export-btn").length&&(b=n("<button>",{"class":"oc-export-btn"+(s.chartClass!==""?" "+s.chartClass:""),text:"Export",click:function(r){var f,u,e;if(r.preventDefault(),n(this).children(".spinner").length)return!1;f=c.find(".mask");f.length?f.removeClass("hidden"):c.append('<div class="mask"><i class="fa fa-circle-o-notch fa-spin spinner"><\/i><\/div>');u=c.addClass("canvasContainer").find(".orgchart:visible").get(0);e=s.direction==="l2r"||s.direction==="r2l";html2canvas(u,{width:e?u.clientHeight:u.clientWidth,height:e?u.clientWidth:u.clientHeight,onclone:function(t){n(t).find(".canvasContainer").css("overflow","visible").find(".orgchart:visible:first").css("transform","")},onrendered:function(n){if(c.find(".mask").addClass("hidden"),s.exportFileextension.toLowerCase()==="pdf"){var r={},u=Math.floor(n.width*.2646),f=Math.floor(n.height*.2646);r=u>f?new jsPDF("l","mm",[u,f]):new jsPDF("p","mm",[f,u]);r.addImage(n.toDataURL(),"png",0,0);r.save(s.exportFilename+".pdf")}else{var e="WebkitAppearance"in i.documentElement.style,o=!!t.sidebar,h=navigator.appName==="Microsoft Internet Explorer"||navigator.appName==="Netscape"&&navigator.appVersion.indexOf("Edge")>-1;(e||o)&&!h?c.find(".oc-download-btn").attr("href",n.toDataURL())[0].click():t.navigator.msSaveBlob(n.msToBlob(),s.exportFilename+".png")}}}).then(function(){c.removeClass("canvasContainer")},function(){c.removeClass("canvasContainer")})}}),c.append(b),s.exportFileextension.toLowerCase()!=="pdf"&&(k='<a class="oc-download-btn'+(s.chartClass!==""?" "+s.chartClass:"")+'" download="'+s.exportFilename+'.png"><\/a>',b.after(k))),s.pan){c.css("overflow","hidden");h.on("mousedown touchstart",function(t){var i=n(this),r,u,f;if(n(t.target).closest(".node").length||t.touches&&t.touches.length>1){i.data("panning",!1);return}i.css("cursor","move").data("panning",!0);var e=0,o=0,s=i.css("transform");if(s!=="none"&&(r=s.split(","),s.indexOf("3d")===-1?(e=parseInt(r[4]),o=parseInt(r[5])):(e=parseInt(r[12]),o=parseInt(r[13]))),u=0,f=0,t.targetTouches){if(t.targetTouches.length===1)u=t.targetTouches[0].pageX-e,f=t.targetTouches[0].pageY-o;else if(t.targetTouches.length>1)return}else u=t.pageX-e,f=t.pageY-o;h.on("mousemove touchmove",function(n){var t,r,o,e;if(i.data("panning")){if(t=0,r=0,n.targetTouches){if(n.targetTouches.length===1)t=n.targetTouches[0].pageX-u,r=n.targetTouches[0].pageY-f;else if(n.targetTouches.length>1)return}else t=n.pageX-u,r=n.pageY-f;o=i.css("transform");o==="none"?o.indexOf("3d")===-1?i.css("transform","matrix(1, 0, 0, 1, "+t+", "+r+")"):i.css("transform","matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+r+", 0, 1)"):(e=o.split(","),o.indexOf("3d")===-1?(e[4]=" "+t,e[5]=" "+r+")"):(e[12]=" "+t,e[13]=" "+r),i.css("transform",e.join(",")))}})});n(i).on("mouseup touchend",function(){h.data("panning")&&h.data("panning",!1).css("cursor","default").off("mousemove")})}if(s.zoom){c.on("wheel",function(n){n.preventDefault();var t=1+(n.originalEvent.deltaY>0?-.2:.2);l(h,t)});c.on("touchstart",function(n){if(n.touches&&n.touches.length===2){h.data("pinching",!0);var t=d(n);h.data("pinchDistStart",t)}});n(i).on("touchmove",function(n){if(h.data("pinching")){var t=d(n);h.data("pinchDistEnd",t)}}).on("touchend",function(){if(h.data("pinching")){h.data("pinching",!1);var n=h.data("pinchDistEnd")-h.data("pinchDistStart");n>0?l(h,1.2):n<0&&l(h,.8)}})}return c}});